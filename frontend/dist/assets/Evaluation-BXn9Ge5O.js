import{_ as S,c as n,o as u,b as s,i as k,h,m as w,F as p,j as y,t as m,e as E,n as C,v as j,u as P,f as d,q as M,g as N,C as V,K as A}from"./index-C-Ksv_Lv.js";const B={name:"Evaluation",setup(){P();const b=d(""),e=d(""),c=d({}),a=d([]),v=d(!1),g=d(""),t=d(""),f=[{id:"ponctualite",label:"Ponctualité"},{id:"assiduite",label:"Assiduité"},{id:"aptitudePro",label:"Aptitudes Professionnelles"},{id:"savoirEtre",label:"Savoir-être"},{id:"curiosite",label:"Curiosité"}],r=M(()=>Object.values(c.value).reduce((o,i)=>o+i,0)),x=async()=>{try{v.value=!0;const o=localStorage.getItem("token"),i=await V.get("http://localhost:3002/api/affectations/tuteur/stagiaires",{headers:{Authorization:`Bearer ${o}`}});a.value=i.data.map(l=>{var _;return{id:l.userId,nom:(_=l.user)!=null&&_.profile?`${l.user.profile.prenom} ${l.user.profile.nom}`:l.userId}})}catch{t.value="Erreur lors du chargement des stagiaires."}finally{v.value=!1}};return N(()=>{x()}),{selectedStagiaire:b,commentaire:e,evaluations:c,criteres:f,stagiaires:a,evaluer:(o,i)=>{c.value[o]=i},soumettreEvaluation:async()=>{var o,i;if(r.value!==20){t.value="Le total des notes doit être égal à 20";return}try{v.value=!0,await A.createEvaluation({stagiaireId:b.value,criteres:c.value,commentaire:e.value}),g.value="Évaluation soumise avec succès !",t.value="",b.value="",e.value="",c.value={}}catch(l){t.value=((i=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:i.message)||"Erreur lors de la soumission.",g.value=""}finally{v.value=!1}},totalPoints:r,loading:v,successMessage:g,errorMessage:t}}},I={class:"p-6"},z={class:"bg-white rounded-lg shadow p-6"},D={class:"mb-6"},F=["value"],L={key:0,class:"space-y-6"},T={class:"mb-4 p-4 bg-blue-50 rounded-lg"},U={class:"text-blue-800"},q={class:"flex justify-between items-center mb-3"},K={class:"font-medium text-gray-900"},O={class:"text-sm text-gray-600"},G={class:"flex items-center space-x-4"},H=["onClick"],J={class:"mt-6"},Q={class:"flex justify-end mt-6"},R=["disabled"];function W(b,e,c,a,v,g){return u(),n("div",I,[e[7]||(e[7]=s("div",{class:"mb-6"},[s("h1",{class:"text-2xl font-bold text-gray-800"},"Évaluation des Stagiaires")],-1)),s("div",z,[s("div",D,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Sélectionner un stagiaire",-1)),h(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.selectedStagiaire=t),class:"w-full border border-gray-300 rounded-lg p-2"},[e[3]||(e[3]=s("option",{value:""},"Choisir un stagiaire",-1)),(u(!0),n(p,null,y(a.stagiaires,t=>(u(),n("option",{key:t.id,value:t.id},m(t.nom),9,F))),128))],512),[[w,a.selectedStagiaire]])]),a.selectedStagiaire?(u(),n("div",L,[s("div",T,[s("p",U,[e[5]||(e[5]=s("i",{class:"fas fa-info-circle mr-2"},null,-1)),E(" Note totale: "+m(a.totalPoints)+"/20 ",1)])]),(u(!0),n(p,null,y(a.criteres,(t,f)=>(u(),n("div",{key:f,class:"border-b pb-4"},[s("div",q,[s("h3",K,m(t.label),1),s("span",O,"Note: "+m(a.evaluations[t.id]||0)+"/4",1)]),s("div",G,[(u(),n(p,null,y(4,r=>s("button",{key:r,onClick:x=>a.evaluer(t.id,r),class:C(["w-10 h-10 rounded-full flex items-center justify-center",a.evaluations[t.id]===r?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},m(r),11,H)),64))])]))),128)),s("div",J,[e[6]||(e[6]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Commentaires",-1)),h(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.commentaire=t),rows:"4",class:"w-full border border-gray-300 rounded-lg p-2",placeholder:"Ajouter vos observations..."},null,512),[[j,a.commentaire]])]),s("div",Q,[s("button",{onClick:e[2]||(e[2]=(...t)=>a.soumettreEvaluation&&a.soumettreEvaluation(...t)),class:"bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-700",disabled:a.totalPoints>20}," Soumettre l'évaluation ",8,R)])])):k("",!0)])])}const $=S(B,[["render",W]]);export{$ as default};
