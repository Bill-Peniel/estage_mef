import{_ as A,c as u,o as l,b as s,i as C,e as M,t as n,F as w,j as k,l as j,h as E,v as N,u as I,I as V,f as c,g as B}from"./index-C-Ksv_Lv.js";const T={name:"SousStructure",setup(){const f=I(),t=V(),i=c(!1),e=c(null),b=c([]),S=c([]),r=c(!1),d=c({nom:""}),a=async()=>{try{i.value=!0;const o=await f.dispatch("sousStructure/getSousStructure");console.log("Réponse de la sous-structure:",o),o?(e.value=o,b.value=o.membres||[],S.value=o.children||[]):(console.error("Aucune sous-structure trouvée"),t.error("Aucune sous-structure trouvée"))}catch(o){console.error("Erreur lors de la récupération de la sous-structure:",o),t.error(o.message||"Erreur lors de la récupération de la sous-structure")}finally{i.value=!1}},v=async()=>{try{i.value=!0,await f.dispatch("sousStructure/addSubStructure",{nomStructure:d.value.nom,parentId:e.value.id}),r.value=!1,d.value.nom="",t.success("Sous-structure créée avec succès"),await a()}catch(o){console.error("Erreur lors de la création de la sous-structure:",o),t.error(o.message||"Erreur lors de la création de la sous-structure")}finally{i.value=!1}},g=async o=>{console.log("Édition de la sous-structure:",o)},p=async o=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette sous-structure ?"))try{i.value=!0,await f.dispatch("sousStructure/removeSubStructure",o.id),t.success("Sous-structure supprimée avec succès"),await a()}catch(m){console.error("Erreur lors de la suppression de la sous-structure:",m),t.error(m.message||"Erreur lors de la suppression de la sous-structure")}finally{i.value=!1}};return B(a),{loading:i,sousStructure:e,membres:b,sousStructures:S,showAddSubStructureModal:r,newSubStructure:d,handleAddSubStructure:v,editSubStructure:g,removeSubStructure:p}}},D={class:"min-h-screen bg-gray-100"},F={class:"flex-1"},q={class:"bg-white shadow"},z={class:"px-4 py-4 flex justify-between items-center"},L={class:"p-6"},R={key:0,class:"flex justify-center items-center h-64"},U={key:1,class:"space-y-6"},G={class:"bg-white shadow rounded-lg p-6"},H={class:"grid grid-cols-2 gap-4"},J={class:"font-medium"},K={class:"font-medium"},O={class:"bg-white shadow rounded-lg p-6"},P={key:0,class:"text-gray-500 text-center py-4"},Q={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},W={class:"flex items-center space-x-3"},X={class:"flex-shrink-0"},Y={class:"h-10 w-10 rounded-full bg-primary flex items-center justify-center text-white"},Z={class:"font-medium"},$={class:"text-sm text-gray-500"},ss={class:"bg-white shadow rounded-lg p-6"},ts={key:0,class:"text-gray-500 text-center py-4"},es={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},rs={class:"flex justify-between items-start"},os={class:"font-medium"},us={class:"text-sm text-gray-500"},ls={class:"flex space-x-2"},ns=["onClick"],is=["onClick"],ds={key:2,class:"text-center py-12"},as={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},cs={class:"bg-white rounded-lg p-6 max-w-md w-full"},ms={class:"mb-3"},fs={class:"text-end"},vs=["disabled"];function gs(f,t,i,e,b,S){return l(),u("div",D,[s("div",F,[s("header",q,[s("div",z,[t[5]||(t[5]=s("h1",{class:"text-2xl font-bold text-primary"},"Ma sous-structure",-1)),s("button",{onClick:t[0]||(t[0]=r=>e.showAddSubStructureModal=!0),class:"bg-primary text-white px-4 py-2 rounded hover:bg-green-900"},t[4]||(t[4]=[s("i",{class:"fas fa-plus mr-2"},null,-1),M(" Ajouter une sous-structure ")]))])]),s("main",L,[e.loading?(l(),u("div",R,t[6]||(t[6]=[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)]))):e.sousStructure?(l(),u("div",U,[s("div",G,[t[9]||(t[9]=s("h2",{class:"text-xl font-semibold mb-4"},"Informations",-1)),s("div",H,[s("div",null,[t[7]||(t[7]=s("p",{class:"text-sm text-gray-600"},"Nom",-1)),s("p",J,n(e.sousStructure.nomStructure),1)]),s("div",null,[t[8]||(t[8]=s("p",{class:"text-sm text-gray-600"},"Sigle",-1)),s("p",K,n(e.sousStructure.sigle),1)])])]),s("div",O,[t[10]||(t[10]=s("h2",{class:"text-xl font-semibold mb-4"},"Membres",-1)),e.membres.length===0?(l(),u("div",P," Aucun membre pour le moment ")):(l(),u("div",Q,[(l(!0),u(w,null,k(e.membres,r=>{var d,a,v,g,p,o,m,x,y,h,_;return l(),u("div",{key:r.id,class:"border rounded-lg p-4"},[s("div",W,[s("div",X,[s("div",Y,n((v=(a=(d=r.user)==null?void 0:d.profile)==null?void 0:a.prenom)==null?void 0:v[0])+n((o=(p=(g=r.user)==null?void 0:g.profile)==null?void 0:p.nom)==null?void 0:o[0]),1)]),s("div",null,[s("p",Z,n((x=(m=r.user)==null?void 0:m.profile)==null?void 0:x.prenom)+" "+n((h=(y=r.user)==null?void 0:y.profile)==null?void 0:h.nom),1),s("p",$,n((_=r.user)==null?void 0:_.email),1)])])])}),128))]))]),s("div",ss,[t[13]||(t[13]=s("h2",{class:"text-xl font-semibold mb-4"},"Sous-structures",-1)),e.sousStructures.length===0?(l(),u("div",ts," Aucune sous-structure pour le moment ")):(l(),u("div",es,[(l(!0),u(w,null,k(e.sousStructures,r=>(l(),u("div",{key:r.id,class:"border rounded-lg p-4"},[s("div",rs,[s("div",null,[s("h3",os,n(r.nomStructure),1),s("p",us,n(r.sigle),1)]),s("div",ls,[s("button",{onClick:d=>e.editSubStructure(r),class:"text-primary hover:text-primary-dark"},t[11]||(t[11]=[s("i",{class:"fas fa-edit"},null,-1)]),8,ns),s("button",{onClick:d=>e.removeSubStructure(r),class:"text-danger hover:text-red-700"},t[12]||(t[12]=[s("i",{class:"fas fa-trash"},null,-1)]),8,is)])])]))),128))]))])])):(l(),u("div",ds,t[14]||(t[14]=[s("p",{class:"text-gray-500"},"Aucune sous-structure trouvée",-1)])))])]),e.showAddSubStructureModal?(l(),u("div",as,[s("div",cs,[t[16]||(t[16]=s("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Ajouter une sous-structure",-1)),s("form",{onSubmit:t[3]||(t[3]=j((...r)=>e.handleAddSubStructure&&e.handleAddSubStructure(...r),["prevent"]))},[s("div",ms,[t[15]||(t[15]=s("label",{for:"nom",class:"form-label"},"Nom de la sous-structure",-1)),E(s("input",{type:"text",class:"mt-1 input-field",id:"nom","onUpdate:modelValue":t[1]||(t[1]=r=>e.newSubStructure.nom=r),required:""},null,512),[[N,e.newSubStructure.nom]])]),s("div",fs,[s("button",{type:"button",class:"btn-outline me-2",onClick:t[2]||(t[2]=r=>e.showAddSubStructureModal=!1)}," Annuler "),s("button",{type:"submit",class:"btn-primary",disabled:e.loading},n(e.loading?"Création en cours...":"Créer"),9,vs)])],32)])])):C("",!0)])}const bs=A(T,[["render",gs],["__scopeId","data-v-4803966e"]]);export{bs as default};
