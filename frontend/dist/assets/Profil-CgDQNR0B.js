import{_ as g,c as x,o as P,b as e,l as k,h as d,v as E,E as u,n as f,t as V,u as h,I as C,f as m,N as y}from"./index-C-Ksv_Lv.js";const j={name:"Profil",setup(){var v;const r=h(),s=C(),i=m(!1),t=m({email:((v=r.state.user)==null?void 0:v.email)||""}),l=m({old:"",new:"",confirm:""}),n=m({old:!1,new:!1,confirm:!1}),o=a=>{n.value[a]=!n.value[a]},b=()=>l.value.new&&!l.value.old?(s.error("Veuillez entrer votre ancien mot de passe"),!1):l.value.new&&l.value.new!==l.value.confirm?(s.error("Les mots de passe ne correspondent pas"),!1):l.value.new&&l.value.new.length<8?(s.error("Le mot de passe doit contenir au moins 8 caractères"),!1):!0;return{profile:t,passwords:l,loading:i,showPasswords:n,togglePasswordVisibility:o,saveProfile:async()=>{var a,p,c;if(b())try{i.value=!0,t.value.email!==((a=r.state.user)==null?void 0:a.email)&&(await y.updateEmail(t.value.email),await r.dispatch("updateUserEmail",t.value.email),s.success("Email mis à jour avec succès")),l.value.new&&(await y.updatePassword({oldPassword:l.value.old,newPassword:l.value.new}),s.success("Mot de passe mis à jour avec succès"),l.value={old:"",new:"",confirm:""}),s.success("Profil mis à jour avec succès")}catch(w){console.error("Erreur lors de la mise à jour du profil:",w),s.error(((c=(p=w.response)==null?void 0:p.data)==null?void 0:c.message)||"Erreur lors de la mise à jour du profil")}finally{i.value=!1}},resetForm:()=>{var a;t.value={email:((a=r.state.user)==null?void 0:a.email)||""},l.value={old:"",new:"",confirm:""}}}}},F={class:"p-6"},M={class:"bg-white rounded-lg shadow-sm p-6 max-w-2xl"},U={class:"space-y-4"},S={class:"relative"},B=["type"],D={class:"relative"},L=["type"],N={class:"relative"},z=["type"],A={class:"flex justify-end space-x-3"},I=["disabled"];function T(r,s,i,t,l,n){return P(),x("div",F,[s[15]||(s[15]=e("h1",{class:"text-2xl text-slate-800 font-bold mb-6"},"Mon Profil",-1)),e("div",M,[e("form",{onSubmit:s[8]||(s[8]=k((...o)=>t.saveProfile&&t.saveProfile(...o),["prevent"])),class:"space-y-6"},[e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Email ",-1)),d(e("input",{type:"email","onUpdate:modelValue":s[0]||(s[0]=o=>t.profile.email=o),class:"input-field",required:""},null,512),[[E,t.profile.email]])]),e("div",U,[s[14]||(s[14]=e("h3",{class:"text-lg font-semibold"},"Changer le mot de passe",-1)),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Ancien mot de passe ",-1)),e("div",S,[d(e("input",{type:t.showPasswords.old?"text":"password","onUpdate:modelValue":s[1]||(s[1]=o=>t.passwords.old=o),class:"input-field pr-10"},null,8,B),[[u,t.passwords.old]]),e("button",{type:"button",onClick:s[2]||(s[2]=o=>t.togglePasswordVisibility("old")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},[e("i",{class:f(t.showPasswords.old?"fas fa-eye-slash":"fas fa-eye")},null,2)])])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nouveau mot de passe ",-1)),e("div",D,[d(e("input",{type:t.showPasswords.new?"text":"password","onUpdate:modelValue":s[3]||(s[3]=o=>t.passwords.new=o),class:"input-field pr-10",minlength:"8"},null,8,L),[[u,t.passwords.new]]),e("button",{type:"button",onClick:s[4]||(s[4]=o=>t.togglePasswordVisibility("new")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},[e("i",{class:f(t.showPasswords.new?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),s[12]||(s[12]=e("p",{class:"mt-1 text-sm text-gray-500"},"Le mot de passe doit contenir au moins 8 caractères",-1))]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Confirmer le nouveau mot de passe ",-1)),e("div",N,[d(e("input",{type:t.showPasswords.confirm?"text":"password","onUpdate:modelValue":s[5]||(s[5]=o=>t.passwords.confirm=o),class:"input-field pr-10"},null,8,z),[[u,t.passwords.confirm]]),e("button",{type:"button",onClick:s[6]||(s[6]=o=>t.togglePasswordVisibility("confirm")),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},[e("i",{class:f(t.showPasswords.confirm?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])]),e("div",A,[e("button",{type:"button",onClick:s[7]||(s[7]=(...o)=>t.resetForm&&t.resetForm(...o)),class:"btn-outline"}," Annuler "),e("button",{type:"submit",class:"btn-primary",disabled:t.loading},V(t.loading?"Enregistrement...":"Enregistrer les modifications"),9,I)])],32)])])}const H=g(j,[["render",T],["__scopeId","data-v-f1a55b01"]]);export{H as default};
