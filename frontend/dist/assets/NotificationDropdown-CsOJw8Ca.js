import{_ as w,u as N,f as g,q as C,g as p,Q as A,r as M,c as n,o as r,b as a,i as u,t as f,d as R,w as D,e as I,F as E,j as V,n as x,M as v}from"./index-C-Ksv_Lv.js";const j={name:"NotificationDropdown",setup(){N();const l=g(!1),e=g(null),d=g([]),o=C(()=>d.value.filter(t=>!t.read).length),h=t=>{const i={info:"bg-blue-500",success:"bg-green-500",warning:"bg-yellow-500",error:"bg-red-500"};return i[t]||i.info},y=t=>{const i={info:"fas fa-info",success:"fas fa-check",warning:"fas fa-exclamation",error:"fas fa-times"};return i[t]||i.info},m=t=>new Date(t).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit"}),s=()=>{l.value=!l.value},c=async()=>{try{const t=await v.getNotifications();d.value=t}catch(t){console.error("Erreur lors de la récupération des notifications:",t)}},k=async t=>{try{await v.markAsRead(t),await c()}catch(i){console.error("Erreur lors du marquage de la notification comme lue:",i)}},b=async()=>{try{await v.markAllAsRead(),await c()}catch(t){console.error("Erreur lors du marquage de toutes les notifications comme lues:",t)}},_=t=>{e.value&&!e.value.contains(t.target)&&(l.value=!1)};return p(()=>{c(),document.addEventListener("click",_);const t=setInterval(c,3e4);A(()=>{document.removeEventListener("click",_),clearInterval(t)})}),{showNotifMenu:l,notifMenu:e,notifications:d,unreadCount:o,toggleNotifMenu:s,markAsRead:k,markAllAsRead:b,getNotificationIconClass:h,getNotificationIcon:y,formatDate:m}}},q={class:"relative",ref:"notifMenu"},B={key:0,class:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center"},L={key:0,class:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg overflow-hidden z-50"},S={class:"p-4 border-b border-gray-200 flex justify-between items-center"},F={class:"flex items-center space-x-2"},z={class:"max-h-96 overflow-y-auto"},T={key:0,class:"p-4 text-center text-gray-500"},O={key:1,class:"divide-y divide-gray-200"},Q={class:"flex items-start"},U={class:"flex-shrink-0"},G={class:"ml-3 flex-1"},H={class:"text-sm font-medium text-gray-900"},J={class:"text-sm text-gray-500 mt-1"},K={class:"text-xs text-gray-400 mt-1"},P=["onClick"];function W(l,e,d,o,h,y){const m=M("router-link");return r(),n("div",q,[a("button",{onClick:e[0]||(e[0]=(...s)=>o.toggleNotifMenu&&o.toggleNotifMenu(...s)),class:"text-white hover:text-accent-yellow relative"},[e[3]||(e[3]=a("i",{class:"fas fa-bell text-xl"},null,-1)),o.unreadCount>0?(r(),n("span",B,f(o.unreadCount),1)):u("",!0)]),o.showNotifMenu?(r(),n("div",L,[a("div",S,[e[5]||(e[5]=a("h3",{class:"text-lg font-semibold text-gray-900"},"Notifications",-1)),a("div",F,[o.unreadCount>0?(r(),n("button",{key:0,onClick:e[1]||(e[1]=(...s)=>o.markAllAsRead&&o.markAllAsRead(...s)),class:"text-sm text-blue-600 hover:text-blue-800"}," Tout marquer comme lu ")):u("",!0),R(m,{to:"/dashboard/dpaf/notifications",class:"text-sm text-blue-600 hover:text-blue-800",onClick:e[2]||(e[2]=s=>o.showNotifMenu=!1)},{default:D(()=>e[4]||(e[4]=[I(" Voir tout ")])),_:1})])]),a("div",z,[o.notifications.length===0?(r(),n("div",T," Aucune notification ")):(r(),n("div",O,[(r(!0),n(E,null,V(o.notifications,s=>(r(),n("div",{key:s.id,class:x(["p-4 hover:bg-gray-50 transition-colors duration-200",{"bg-blue-50":!s.read}])},[a("div",Q,[a("div",U,[a("span",{class:x([o.getNotificationIconClass(s.type),"inline-flex items-center justify-center h-8 w-8 rounded-full"])},[a("i",{class:x([o.getNotificationIcon(s.type),"text-white"])},null,2)],2)]),a("div",G,[a("p",H,f(s.title),1),a("p",J,f(s.message),1),a("p",K,f(o.formatDate(s.createdAt)),1)]),s.read?u("",!0):(r(),n("button",{key:0,onClick:c=>o.markAsRead(s.id),class:"ml-2 text-gray-400 hover:text-gray-600"},e[6]||(e[6]=[a("i",{class:"fas fa-check"},null,-1)]),8,P))])],2))),128))]))])])):u("",!0)],512)}const Y=w(j,[["render",W],["__scopeId","data-v-3a15bf1d"]]);export{Y as N};
