import{_ as y,c as n,o as r,b as t,F as _,j as x,t as i,n as c,e as C,k as S,u as k,f as d,g as B}from"./index-C-Ksv_Lv.js";import{C as p}from"./auto-Cz6uSJnr.js";import{b as F,c as T}from"./statistics.service-BiX3GDSV.js";const N={name:"StructureOverview",setup(){const h=k(),o=d(null),u=d(null),l=d(null),g=d([]),m=d([]);return B(async()=>{var v;const e=(v=h.state.user)==null?void 0:v.structureId;if(!e)return;const a=await F(e);g.value=[{title:"Total des stagiaires",value:a.general.total,trend:a.general.trend,icon:"fas fa-users",iconColor:"bg-blue-100 text-blue-600"},{title:"Tuteurs actifs",value:a.tuteurs.length,trend:0,icon:"fas fa-chalkboard-teacher",iconColor:"bg-green-100 text-green-600"},{title:"Taux de completion",value:a.general.tauxCompletion+"%",trend:a.general.trendCompletion,icon:"fas fa-check-circle",iconColor:"bg-yellow-100 text-yellow-600"},{title:"Taux de satisfaction",value:a.general.tauxSatisfaction+"/5",trend:a.general.trendSatisfaction,icon:"fas fa-star",iconColor:"bg-purple-100 text-purple-600"}];const f=await T(e),b=f.reduce((s,w)=>s+w.count,0);m.value=f.map(s=>({name:s.nom,count:s.count,percentage:b?Math.round(s.count/b*100):0})),new p(o.value,{type:"bar",data:{labels:a.evolution.map(s=>s.month),datasets:[{label:"Nombre de stagiaires",data:a.evolution.map(s=>s.count),backgroundColor:"#3B82F6"}]}}),new p(u.value,{type:"doughnut",data:{labels:a.types.map(s=>s.type),datasets:[{data:a.types.map(s=>s.count),backgroundColor:["#3B82F6","#10B981","#8B5CF6"]}]}}),new p(l.value,{type:"bar",data:{labels:a.education.map(s=>s.niveau),datasets:[{label:"Nombre de stagiaires",data:a.education.map(s=>s.count),backgroundColor:"#60A5FA"}]}})}),{generalStats:g,tuteurStats:m,monthlyChart:o,typeChart:u,educationChart:l}}},j={class:"p-6"},M={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},O={class:"flex justify-between items-center"},R={class:"text-sm text-gray-600"},z={class:"text-3xl font-bold mt-2"},A={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},I={class:"bg-white p-6 rounded-lg shadow-sm"},V={ref:"monthlyChart",height:"300"},$={class:"bg-white p-6 rounded-lg shadow-sm"},D={ref:"typeChart",height:"300"},E={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},L={class:"bg-white p-6 rounded-lg shadow-sm"},q={class:"space-y-4"},G={class:"flex-1"},H={class:"flex justify-between mb-1"},J={class:"text-sm font-medium"},K={class:"text-sm text-gray-600"},P={class:"w-full bg-gray-200 rounded-full h-2"},Q={class:"bg-white p-6 rounded-lg shadow-sm"},U={ref:"educationChart",height:"300"};function W(h,o,u,l,g,m){return r(),n("div",j,[t("div",M,[(r(!0),n(_,null,x(l.generalStats,e=>(r(),n("div",{key:e.title,class:"bg-white p-6 rounded-lg shadow-sm"},[t("div",O,[t("div",null,[t("p",R,i(e.title),1),t("h2",z,i(e.value),1),t("p",{class:c(["text-sm mt-2",e.trend>=0?"text-green-600":"text-red-600"])},[t("i",{class:c(e.trend>=0?"fas fa-arrow-up":"fas fa-arrow-down")},null,2),C(" "+i(Math.abs(e.trend))+"% depuis le mois dernier ",1)],2)]),t("div",{class:c([e.iconColor,"p-4 rounded-full"])},[t("i",{class:c([e.icon,"text-2xl"])},null,2)],2)])]))),128))]),t("div",A,[t("div",I,[o[0]||(o[0]=t("h3",{class:"text-lg font-semibold mb-4"},"Évolution mensuelle des stagiaires",-1)),t("canvas",V,null,512)]),t("div",$,[o[1]||(o[1]=t("h3",{class:"text-lg font-semibold mb-4"},"Répartition par type de stage",-1)),t("canvas",D,null,512)])]),t("div",E,[t("div",L,[o[2]||(o[2]=t("h3",{class:"text-lg font-semibold mb-4"},"Répartition par tuteur",-1)),t("div",q,[(r(!0),n(_,null,x(l.tuteurStats,e=>(r(),n("div",{key:e.name,class:"flex items-center"},[t("div",G,[t("div",H,[t("span",J,i(e.name),1),t("span",K,i(e.count)+" stagiaires",1)]),t("div",P,[t("div",{class:"bg-blue-600 h-2 rounded-full",style:S({width:e.percentage+"%"})},null,4)])])]))),128))])]),t("div",Q,[o[3]||(o[3]=t("h3",{class:"text-lg font-semibold mb-4"},"Répartition par niveau d'études",-1)),t("canvas",U,null,512)])])])}const tt=y(N,[["render",W]]);export{tt as default};
