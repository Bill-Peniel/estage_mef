import{_ as q,c as l,o as n,b as e,i as v,h as E,v as R,m as G,t as a,F as M,j as F,n as b,e as S,u as H,f as u,q as m,g as J,S as I}from"./index-C-Ksv_Lv.js";const K={name:"Stagiaires",setup(){const _=H(),t=u(""),f=u("all"),s=u(1),p=10,y=u(!1),r=u(null),c=u([]),h=u(!1),w=u(null),k=m(()=>{const o=_.state.user;return o==null?void 0:o.structureId}),T=async()=>{if(!k.value){r.value="Structure non trouvée";return}y.value=!0,r.value=null;try{const o=await I.getStagiairesByStructure(k.value);c.value=o.map(i=>({id:i.id,nom:`${i.user.profile.nom} ${i.user.profile.prenom}`,email:i.user.email,typeStage:i.typeStage,dateDebut:i.dateDebut,dateFin:i.dateFin,tuteur:i.tuteur?`${i.tuteur.user.profile.nom} ${i.tuteur.user.profile.prenom}`:"Non assigné",statut:j(i.dateDebut,i.dateFin)}))}catch(o){console.error("Erreur lors du chargement des stagiaires:",o),r.value="Erreur lors du chargement des stagiaires"}finally{y.value=!1}},j=(o,i)=>{const d=new Date,g=new Date(o),x=new Date(i);return d<g?"À venir":d>x?"Terminé":"En cours"},P=m(()=>{let o=c.value;if(t.value){const i=t.value.toLowerCase();o=o.filter(d=>d.nom.toLowerCase().includes(i)||d.email.toLowerCase().includes(i))}if(f.value!=="all"){const i={active:"En cours",completed:"Terminé",upcoming:"À venir"};o=o.filter(d=>d.statut===i[f.value])}return o}),D=m(()=>P.value.length),C=m(()=>Math.ceil(D.value/p)),L=m(()=>(s.value-1)*p+1),N=m(()=>Math.min(s.value*p,D.value)),V=m(()=>{const o=[];let d=Math.max(1,s.value-Math.floor(2.5)),g=Math.min(C.value,d+5-1);g-d+1<5&&(d=Math.max(1,g-5+1));for(let x=d;x<=g;x++)o.push(x);return o}),z=o=>o.split(" ").map(i=>i[0]).join("").toUpperCase(),A=o=>new Date(o).toLocaleDateString("fr-FR"),B=o=>{const i={"En cours":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",Terminé:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800","À venir":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"};return i[o]||i["En cours"]},U=async o=>{try{const i=await I.getStagiaireDetails(o.id);w.value=i,h.value=!0}catch(i){console.error("Erreur lors de la récupération des détails:",i),_.dispatch("notification/setError","Erreur lors de la récupération des détails")}},Q=()=>{h.value=!1,w.value=null};return J(()=>{T()}),{searchQuery:t,statusFilter:f,currentPage:s,stagiaires:c,filteredStagiaires:P,totalItems:D,totalPages:C,startIndex:L,endIndex:N,displayedPages:V,loading:y,error:r,showDetailsModal:h,selectedStagiaire:w,getInitials:z,formatDate:A,getStatusClass:B,viewDetails:U,closeDetailsModal:Q}}},O={class:"container mx-auto px-4 py-8"},W={class:"mb-8"},X={class:"flex justify-between items-center mb-6"},Y={class:"flex gap-4"},Z={class:"relative"},$={key:0,class:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded"},ee={key:1,class:"flex justify-center items-center py-8"},te={key:2,class:"bg-white rounded-lg shadow overflow-hidden"},se={class:"overflow-x-auto"},ae={class:"min-w-full divide-y divide-gray-200"},re={class:"bg-white divide-y divide-gray-200"},ie={class:"px-6 py-4 whitespace-nowrap"},oe={class:"flex items-center"},le={class:"flex-shrink-0 h-10 w-10"},ne={class:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center"},de={class:"text-primary font-medium"},ue={class:"ml-4"},me={class:"text-sm font-medium text-gray-900"},ce={class:"text-sm text-gray-500"},ge={class:"px-6 py-4 whitespace-nowrap"},xe={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},fe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ye={class:"px-6 py-4 whitespace-nowrap"},ve={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},be={class:"flex space-x-3"},Se=["onClick"],_e={class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},he={class:"flex-1 flex justify-between sm:hidden"},we=["disabled"],De=["disabled"],ke={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Pe={class:"text-sm text-gray-700"},Ce={class:"font-medium"},Ee={class:"font-medium"},Me={class:"font-medium"},Fe={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Ie=["disabled"],Te=["onClick"],je=["disabled"],Le={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ne={class:"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Ve={class:"flex justify-between items-center mb-4"},ze={key:0,class:"space-y-4"},Ae={class:"bg-gray-50 p-4 rounded-lg"},Be={class:"grid grid-cols-2 gap-4"},Ue={class:"font-medium"},Qe={class:"font-medium"},qe={class:"bg-gray-50 p-4 rounded-lg"},Re={class:"grid grid-cols-2 gap-4"},Ge={class:"font-medium"},He={class:"font-medium"},Je={class:"font-medium"},Ke={class:"bg-gray-50 p-4 rounded-lg"},Oe={key:0,class:"grid grid-cols-2 gap-4"},We={class:"font-medium"},Xe={class:"font-medium"},Ye={key:1,class:"text-gray-500"},Ze={key:0,class:"bg-gray-50 p-4 rounded-lg"},$e={class:"grid grid-cols-2 gap-4"},et={class:"font-medium"},tt={class:"font-medium"},st={class:"font-medium"},at={class:"font-medium"},rt={class:"font-medium"},it={class:"col-span-2"},ot={class:"font-medium"},lt={class:"col-span-2"},nt={class:"font-medium"},dt={class:"col-span-2"},ut={class:"font-medium"};function mt(_,t,f,s,p,y){return n(),l("div",O,[e("div",W,[e("div",X,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold text-gray-800"},"Liste des Stagiaires",-1)),e("div",Y,[e("div",Z,[E(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>s.searchQuery=r),placeholder:"Rechercher un stagiaire...",class:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"},null,512),[[R,s.searchQuery]]),t[7]||(t[7]=e("i",{class:"fas fa-search absolute left-3 top-3 text-gray-400"},null,-1))]),E(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>s.statusFilter=r),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"},t[8]||(t[8]=[e("option",{value:"all"},"Tous les statuts",-1),e("option",{value:"active"},"En cours",-1),e("option",{value:"completed"},"Terminés",-1),e("option",{value:"upcoming"},"À venir",-1)]),512),[[G,s.statusFilter]])])])]),s.error?(n(),l("div",$,a(s.error),1)):v("",!0),s.loading?(n(),l("div",ee,t[10]||(t[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"},null,-1)]))):(n(),l("div",te,[e("div",se,[e("table",ae,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Stagiaire "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Type de stage "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Période "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tuteur "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",re,[(n(!0),l(M,null,F(s.filteredStagiaires,r=>(n(),l("tr",{key:r.id,class:"hover:bg-gray-50"},[e("td",ie,[e("div",oe,[e("div",le,[e("div",ne,[e("span",de,a(s.getInitials(r.nom)),1)])]),e("div",ue,[e("div",me,a(r.nom),1),e("div",ce,a(r.email),1)])])]),e("td",ge,[e("span",xe,a(r.typeStage),1)]),e("td",fe,a(s.formatDate(r.dateDebut))+" - "+a(s.formatDate(r.dateFin)),1),e("td",pe,a(r.tuteur),1),e("td",ye,[e("span",{class:b(s.getStatusClass(r.statut))},a(r.statut),3)]),e("td",ve,[e("div",be,[e("button",{onClick:c=>s.viewDetails(r),class:"text-primary hover:text-primary-dark"},t[11]||(t[11]=[e("i",{class:"fas fa-eye"},null,-1)]),8,Se)])])]))),128))])])]),e("div",_e,[e("div",he,[e("button",{onClick:t[2]||(t[2]=r=>s.currentPage--),disabled:s.currentPage===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Précédent ",8,we),e("button",{onClick:t[3]||(t[3]=r=>s.currentPage++),disabled:s.currentPage===s.totalPages,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Suivant ",8,De)]),e("div",ke,[e("div",null,[e("p",Pe,[t[13]||(t[13]=S(" Affichage de ")),e("span",Ce,a(s.startIndex),1),t[14]||(t[14]=S(" à ")),e("span",Ee,a(s.endIndex),1),t[15]||(t[15]=S(" sur ")),e("span",Me,a(s.totalItems),1),t[16]||(t[16]=S(" résultats "))])]),e("div",null,[e("nav",Fe,[e("button",{onClick:t[4]||(t[4]=r=>s.currentPage--),disabled:s.currentPage===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},t[17]||(t[17]=[e("span",{class:"sr-only"},"Précédent",-1),e("i",{class:"fas fa-chevron-left"},null,-1)]),8,Ie),(n(!0),l(M,null,F(s.displayedPages,r=>(n(),l("button",{key:r,onClick:c=>s.currentPage=r,class:b([s.currentPage===r?"z-10 bg-primary border-primary text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},a(r),11,Te))),128)),e("button",{onClick:t[5]||(t[5]=r=>s.currentPage++),disabled:s.currentPage===s.totalPages,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},t[18]||(t[18]=[e("span",{class:"sr-only"},"Suivant",-1),e("i",{class:"fas fa-chevron-right"},null,-1)]),8,je)])])])])])),s.showDetailsModal?(n(),l("div",Le,[e("div",Ne,[e("div",Ve,[t[20]||(t[20]=e("h2",{class:"text-xl font-bold text-gray-800"},"Détails du Stagiaire",-1)),e("button",{onClick:t[6]||(t[6]=(...r)=>s.closeDetailsModal&&s.closeDetailsModal(...r)),class:"text-gray-500 hover:text-gray-700"},t[19]||(t[19]=[e("i",{class:"fas fa-times"},null,-1)]))]),s.selectedStagiaire?(n(),l("div",ze,[e("div",Ae,[t[23]||(t[23]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Informations Personnelles",-1)),e("div",Be,[e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm text-gray-600"},"Nom complet",-1)),e("p",Ue,a(s.selectedStagiaire.user.profile.nom)+" "+a(s.selectedStagiaire.user.profile.prenom),1)]),e("div",null,[t[22]||(t[22]=e("p",{class:"text-sm text-gray-600"},"Email",-1)),e("p",Qe,a(s.selectedStagiaire.user.email),1)])])]),e("div",qe,[t[28]||(t[28]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Détails du Stage",-1)),e("div",Re,[e("div",null,[t[24]||(t[24]=e("p",{class:"text-sm text-gray-600"},"Type de stage",-1)),e("p",Ge,a(s.selectedStagiaire.typeStage),1)]),e("div",null,[t[25]||(t[25]=e("p",{class:"text-sm text-gray-600"},"Statut",-1)),e("p",{class:b(["font-medium",s.getStatusClass(s.selectedStagiaire.statut)])},a(s.selectedStagiaire.statut),3)]),e("div",null,[t[26]||(t[26]=e("p",{class:"text-sm text-gray-600"},"Date de début",-1)),e("p",He,a(s.formatDate(s.selectedStagiaire.dateDebut)),1)]),e("div",null,[t[27]||(t[27]=e("p",{class:"text-sm text-gray-600"},"Date de fin",-1)),e("p",Je,a(s.formatDate(s.selectedStagiaire.dateFin)),1)])])]),e("div",Ke,[t[31]||(t[31]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Tuteur",-1)),s.selectedStagiaire.tuteur?(n(),l("div",Oe,[e("div",null,[t[29]||(t[29]=e("p",{class:"text-sm text-gray-600"},"Nom du tuteur",-1)),e("p",We,a(s.selectedStagiaire.tuteur.user.profile.nom)+" "+a(s.selectedStagiaire.tuteur.user.profile.prenom),1)]),e("div",null,[t[30]||(t[30]=e("p",{class:"text-sm text-gray-600"},"Email du tuteur",-1)),e("p",Xe,a(s.selectedStagiaire.tuteur.user.email),1)])])):(n(),l("p",Ye,"Aucun tuteur assigné"))]),s.selectedStagiaire.user.demandesStage?(n(),l("div",Ze,[t[41]||(t[41]=e("h3",{class:"font-semibold text-gray-700 mb-2"},"Détails de la Demande",-1)),e("div",$e,[e("div",null,[t[32]||(t[32]=e("p",{class:"text-sm text-gray-600"},"Code de suivi",-1)),e("p",et,a(s.selectedStagiaire.user.demandesStage.code_suivi),1)]),e("div",null,[t[33]||(t[33]=e("p",{class:"text-sm text-gray-600"},"Université",-1)),e("p",tt,a(s.selectedStagiaire.user.demandesStage.universite),1)]),e("div",null,[t[34]||(t[34]=e("p",{class:"text-sm text-gray-600"},"Département",-1)),e("p",st,a(s.selectedStagiaire.user.demandesStage.departement),1)]),e("div",null,[t[35]||(t[35]=e("p",{class:"text-sm text-gray-600"},"Domaine d'études",-1)),e("p",at,a(s.selectedStagiaire.user.demandesStage.domaineEtude),1)]),e("div",null,[t[36]||(t[36]=e("p",{class:"text-sm text-gray-600"},"Année d'études",-1)),e("p",rt,a(s.selectedStagiaire.user.demandesStage.anneeEtude),1)]),e("div",null,[t[37]||(t[37]=e("p",{class:"text-sm text-gray-600"},"Statut de la demande",-1)),e("p",{class:b(["font-medium",s.getStatusClass(s.selectedStagiaire.user.demandesStage.status)])},a(s.selectedStagiaire.user.demandesStage.status),3)]),e("div",it,[t[38]||(t[38]=e("p",{class:"text-sm text-gray-600"},"Motivation",-1)),e("p",ot,a(s.selectedStagiaire.user.demandesStage.motivation),1)]),e("div",lt,[t[39]||(t[39]=e("p",{class:"text-sm text-gray-600"},"Compétences",-1)),e("p",nt,a(s.selectedStagiaire.user.demandesStage.competences),1)]),e("div",dt,[t[40]||(t[40]=e("p",{class:"text-sm text-gray-600"},"Expérience",-1)),e("p",ut,a(s.selectedStagiaire.user.demandesStage.experience),1)])])])):v("",!0)])):v("",!0)])])):v("",!0)])}const gt=q(K,[["render",mt]]);export{gt as default};
