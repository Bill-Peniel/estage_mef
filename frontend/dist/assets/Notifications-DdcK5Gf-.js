import{_ as N,c as o,o as r,b as e,d as T,w as C,i as x,n as u,e as g,t as k,T as R,F as _,j as M,l as p,f as b,g as j,M as h}from"./index-C-Ksv_Lv.js";const E={name:"TuteurNotifications",setup(){const y=b([]),s=b(!0),f=b(!1),a=b({message:"",success:!0});let m=null;const c=async()=>{s.value=!0;try{y.value=await h.getNotifications()}catch{n("Erreur lors du chargement des notifications",!1)}s.value=!1},t=async i=>{try{await h.markAsRead(i),n("Notification marquée comme lue !",!0),await c()}catch{n("Erreur lors de la mise à jour",!1)}},v=async()=>{f.value=!0;try{await h.markAllAsRead(),n("Toutes les notifications sont lues !",!0),await c()}catch{n("Erreur lors de la mise à jour",!1)}f.value=!1},w=async i=>{if(window.confirm("Supprimer cette notification ?"))try{await h.deleteNotification(i),n("Notification supprimée",!0),await c()}catch{n("Erreur lors de la suppression",!1)}},n=(i,l=!0)=>{a.value={message:i,success:l},m&&clearTimeout(m),m=setTimeout(()=>{a.value.message=""},3500)},A=i=>{if(!i)return"";const l=new Date(i),d=(new Date-l)/1e3;return d<60?"À l’instant":d<3600?`Il y a ${Math.floor(d/60)} min`:d<86400?`Il y a ${Math.floor(d/3600)}h`:l.toLocaleDateString()};return j(()=>{c()}),{notifications:y,loading:s,loadingAll:f,markAsRead:t,markAllAsRead:v,deleteNotif:w,snackbar:a,formatTime:A}}},B={class:"p-6 min-h-screen notifications-bg"},D={class:"bg-white rounded-lg shadow"},S={class:"p-4 border-b flex items-center justify-between"},V=["disabled"],q={class:"divide-y"},I={key:0,class:"p-8 text-center text-gray-400"},z={key:0,class:"p-8 text-center text-gray-400"},F={class:"flex-shrink-0"},L={class:"ml-3 flex-1"},G={class:"text-sm font-medium text-gray-900"},H={class:"text-sm text-gray-500"},J={class:"text-xs text-gray-400"},K={class:"ml-4 flex flex-col items-center gap-2"},O=["onClick"],P=["onClick"],Q={key:1,class:"h-2 w-2 bg-blue-500 rounded-full mt-2"};function U(y,s,f,a,m,c){return r(),o("div",B,[s[6]||(s[6]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Notifications"),e("p",{class:"text-gray-600"},"Gérez vos notifications")],-1)),T(R,{name:"snackbar-fade"},{default:C(()=>[a.snackbar.message?(r(),o("div",{key:0,class:u(["snackbar",a.snackbar.success?"snackbar-success":"snackbar-error"])},[e("i",{class:u([a.snackbar.success?"fas fa-check-circle":"fas fa-exclamation-triangle","mr-2"])},null,2),g(" "+k(a.snackbar.message),1)],2)):x("",!0)]),_:1}),e("div",D,[e("div",S,[s[2]||(s[2]=e("h2",{class:"text-lg font-semibold"},"Toutes les notifications",-1)),e("button",{class:"text-primary hover:text-primary-dark flex items-center",onClick:s[0]||(s[0]=(...t)=>a.markAllAsRead&&a.markAllAsRead(...t)),disabled:a.loadingAll},s[1]||(s[1]=[e("i",{class:"fas fa-check-double mr-2"},null,-1),g("Tout marquer comme lu ")]),8,V)]),e("div",q,[a.loading?(r(),o("div",I,s[3]||(s[3]=[e("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),g("Chargement des notifications... ")]))):(r(),o(_,{key:1},[a.notifications.length===0?(r(),o("div",z,s[4]||(s[4]=[e("i",{class:"fas fa-inbox mr-2"},null,-1),g("Aucune notification à afficher ")]))):x("",!0),(r(!0),o(_,null,M(a.notifications,t=>(r(),o("div",{key:t.id,class:u(["p-4 hover:bg-blue-50 transition-colors cursor-pointer flex items-start group relative",{"opacity-60":t.read}])},[e("div",F,[e("span",{class:u(["w-8 h-8 rounded-full flex items-center justify-center",t.iconBg||"bg-blue-100",t.iconColor||"text-blue-500"])},[e("i",{class:u(t.icon||"fas fa-bell")},null,2)],2)]),e("div",L,[e("p",G,k(t.title),1),e("p",H,k(t.message),1),e("span",J,k(t.time||t.createdAt?a.formatTime(t.time||t.createdAt):""),1)]),e("div",K,[t.read?x("",!0):(r(),o("button",{key:0,onClick:p(v=>a.markAsRead(t.id),["stop"]),class:"text-xs text-primary hover:underline"},"Marquer comme lu",8,O)),e("button",{onClick:p(v=>a.deleteNotif(t.id),["stop"]),class:"text-xs text-red-400 hover:text-red-600"},s[5]||(s[5]=[e("i",{class:"fas fa-trash"},null,-1)]),8,P),t.read?x("",!0):(r(),o("div",Q))])],2))),128))],64))])])])}const Y=N(E,[["render",U],["__scopeId","data-v-57ce9f6a"]]);export{Y as default};
