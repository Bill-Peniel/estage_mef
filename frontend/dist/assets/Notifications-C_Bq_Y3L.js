import{_ as A,c as r,o as l,b as t,i as u,e as C,t as d,F as T,j as R,n as y,f as g,q as m,g as M,y as b}from"./index-C-Ksv_Lv.js";const j={name:"StructureNotifications",setup(){const s=g(1),f=g([]),e=g(!1),c=g(""),n=g(""),a=m(()=>f.value.length),v=m(()=>Math.ceil(a.value/10)),_=m(()=>(s.value-1)*10),h=m(()=>Math.min(_.value+10,a.value)),p=m(()=>f.value.slice(_.value,h.value)),P=o=>{const i={info:"bg-blue-100 text-blue-600",success:"bg-green-100 text-green-600",warning:"bg-yellow-100 text-yellow-600",error:"bg-red-100 text-red-600"};return i[o]||i.info},N=o=>{const i={info:"fa-info",success:"fa-check",warning:"fa-exclamation",error:"fa-times"};return i[o]||i.info},w=o=>new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),x=async()=>{e.value=!0,n.value="";try{const o=await b.getNotifications();f.value=(o||[]).map(i=>({...i,date:i.createdAt||i.date||new Date}))}catch(o){n.value=(o==null?void 0:o.message)||"Erreur lors du chargement des notifications."}finally{e.value=!1}};return M(x),{notifications:p,currentPage:s,totalNotifications:a,totalPages:v,startIndex:_,endIndex:h,getNotificationTypeClass:P,getNotificationIcon:N,formatDate:w,markAsRead:async o=>{try{await b.markAsRead(o),c.value="Notification marquée comme lue.",setTimeout(()=>{c.value=""},3e3),await x()}catch(i){n.value=(i==null?void 0:i.message)||"Erreur lors du marquage comme lu.",setTimeout(()=>{n.value=""},5e3)}},markAllAsRead:async()=>{try{await b.markAllAsRead(),c.value="Toutes les notifications ont été marquées comme lues.",setTimeout(()=>{c.value=""},3e3),await x()}catch(o){n.value=(o==null?void 0:o.message)||"Erreur lors du marquage de toutes les notifications.",setTimeout(()=>{n.value=""},5e3)}},deleteNotification:async o=>{try{await b.deleteNotification(o),c.value="Notification supprimée.",setTimeout(()=>{c.value=""},3e3),await x()}catch(i){n.value=(i==null?void 0:i.message)||"Erreur lors de la suppression de la notification.",setTimeout(()=>{n.value=""},5e3)}},previousPage:()=>{s.value>1&&s.value--},nextPage:()=>{s.value<v.value&&s.value++},loading:e,successMessage:c,errorMessage:n}}},q={class:"bg-white shadow rounded-lg"},D={class:"px-6 py-4 border-b border-gray-200"},I={class:"flex justify-between items-center"},S={class:"flex space-x-3"},E={key:0,class:"m-4 p-3 rounded bg-green-100 text-green-800 border border-green-300"},V={key:1,class:"m-4 p-3 rounded bg-red-100 text-red-800 border border-red-300"},B={key:2,class:"p-6 text-center text-gray-500"},F={key:3,class:"divide-y divide-gray-200"},z={class:"flex items-start justify-between"},L={class:"flex items-start space-x-3"},G={class:"flex-shrink-0"},H={class:"mt-1 text-sm text-gray-500"},J={class:"mt-2 text-xs text-gray-400"},K={class:"flex items-center space-x-2"},O=["onClick"],Q=["onClick"],U={key:0,class:"p-6 text-center"},W={key:4,class:"px-6 py-4 border-t border-gray-200"},X={class:"flex items-center justify-between"},Y={class:"text-sm text-gray-700"},Z={class:"flex space-x-2"},$=["disabled"],ee=["disabled"];function te(k,s,f,e,c,n){return l(),r("div",q,[t("div",D,[t("div",I,[s[4]||(s[4]=t("h2",{class:"text-xl font-semibold text-gray-800"},"Notifications Structure",-1)),t("div",S,[t("button",{onClick:s[0]||(s[0]=(...a)=>e.markAllAsRead&&e.markAllAsRead(...a)),class:"btn-outline flex items-center"},s[3]||(s[3]=[t("i",{class:"fas fa-check-double mr-2"},null,-1),C(" Tout marquer comme lu ")]))])])]),e.successMessage?(l(),r("div",E,d(e.successMessage),1)):u("",!0),e.errorMessage?(l(),r("div",V,d(e.errorMessage),1)):u("",!0),e.loading?(l(),r("div",B,"Chargement...")):(l(),r("div",F,[(l(!0),r(T,null,R(e.notifications,a=>(l(),r("div",{key:a.id,class:y(["p-6 hover:bg-gray-50 transition-colors duration-200",{"bg-blue-50":!a.read}])},[t("div",z,[t("div",L,[t("div",G,[t("span",{class:y(["inline-flex items-center justify-center h-10 w-10 rounded-full",e.getNotificationTypeClass(a.type)])},[t("i",{class:y(["fas",e.getNotificationIcon(a.type)])},null,2)],2)]),t("div",null,[t("p",{class:y(["text-sm font-medium text-gray-900",{"font-bold":!a.read}])},d(a.title),3),t("p",H,d(a.message),1),t("p",J,d(e.formatDate(a.date)),1)])]),t("div",K,[a.read?u("",!0):(l(),r("button",{key:0,onClick:v=>e.markAsRead(a.id),class:"text-primary hover:text-primary-dark"},s[5]||(s[5]=[t("i",{class:"fas fa-check"},null,-1)]),8,O)),t("button",{onClick:v=>e.deleteNotification(a.id),class:"text-gray-400 hover:text-red-600"},s[6]||(s[6]=[t("i",{class:"fas fa-trash"},null,-1)]),8,Q)])])],2))),128)),e.notifications.length===0&&!e.loading?(l(),r("div",U,s[7]||(s[7]=[t("span",{class:"inline-flex items-center justify-center h-12 w-12 rounded-full bg-gray-100 mb-4"},[t("i",{class:"fas fa-bell text-gray-400 text-xl"})],-1),t("h3",{class:"text-sm font-medium text-gray-900"},"Aucune notification",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"Vous n'avez pas de nouvelles notifications.",-1)]))):u("",!0)])),e.notifications.length>0?(l(),r("div",W,[t("div",X,[t("div",Y," Affichage de "+d(e.startIndex+1)+" à "+d(e.endIndex)+" sur "+d(e.totalNotifications)+" notifications ",1),t("div",Z,[t("button",{onClick:s[1]||(s[1]=(...a)=>e.previousPage&&e.previousPage(...a)),disabled:e.currentPage===1,class:"btn-outline py-1 px-3 disabled:opacity-50"}," Précédent ",8,$),t("button",{onClick:s[2]||(s[2]=(...a)=>e.nextPage&&e.nextPage(...a)),disabled:e.currentPage===e.totalPages,class:"btn-outline py-1 px-3 disabled:opacity-50"}," Suivant ",8,ee)])])])):u("",!0)])}const le=A(j,[["render",te]]);export{le as default};
